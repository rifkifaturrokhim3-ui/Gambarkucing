<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hand-Controlled Image</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #222;
  }
  #canvas {
    position: absolute;
    top: 0;
    left: 0;
  }
  #imgObj {
    position: absolute;
    width: 100px;
    height: 100px;
    pointer-events: none; /* biar ga keblok drag */
  }
</style>
</head>
<body>

<img id="imgObj" src="https://i.ibb.co/3y0fZyp/sample.png" alt="object">

<video id="video" width="640" height="480" style="display:none;"></video>
<canvas id="canvas" width="640" height="480"></canvas>

<script type="module">
import {Hands} from 'https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js';
import {Camera} from 'https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js';
import {drawConnectors, drawLandmarks} from 'https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js';

const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const imgObj = document.getElementById('imgObj');

// Inisialisasi MediaPipe Hands
const hands = new Hands({
  locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});

hands.setOptions({
  maxNumHands: 1,
  modelComplexity: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.5
});

hands.onResults((results) => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if(results.multiHandLandmarks && results.multiHandLandmarks.length > 0){
    const landmarks = results.multiHandLandmarks[0];

    // Gambarkan tangan (opsional)
    drawConnectors(ctx, landmarks, Hands.HAND_CONNECTIONS, {color: '#00FF00', lineWidth: 2});
    drawLandmarks(ctx, landmarks, {color: '#FF0000', lineWidth: 1});

    // Ambil koordinat jari tengah (landmark 12)
    const x = landmarks[12].x * canvas.width - imgObj.width/2;
    const y = landmarks[12].y * canvas.height - imgObj.height/2;

    // Gerakkan gambar
    imgObj.style.left = `${x}px`;
    imgObj.style.top = `${y}px`;
  }
});

// Kamera
const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({image: video});
  },
  width: 640,
  height: 480
});
camera.start();
</script>

</body>
</html>
